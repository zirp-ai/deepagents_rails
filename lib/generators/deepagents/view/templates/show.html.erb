<%# DeepAgents %> <%= class_name %> <%# Show View %>
<div class="deepagents-container" data-conversation-id="<%= @conversation.id %>">
  <div class="deepagents-header">
    <h1><%= @conversation.title.presence || "Conversation ##{@conversation.id}" %></h1>
    <div class="deepagents-actions">
      <%= link_to "Back to Conversations", #{file_name.pluralize}_path, class: "deepagents-button secondary" %>
    </div>
  </div>
  
  <div class="deepagents-conversation">
    <div class="deepagents-messages" id="messages-container">
      <%= render partial: "conversation", locals: { conversation: @conversation } %>
    </div>
    
    <div class="deepagents-input-container">
      <%= form_with url: run_#{file_name}_path(@conversation), method: :post, class: "deepagents-form", id: "message-form", data: { remote: true } do |f| %>
        <div class="deepagents-file-upload">
          <%= f.file_field :file, id: "file-upload", class: "deepagents-file-input" %>
          <label for="file-upload" class="deepagents-file-label">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5 1.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0V3z"/>
            </svg>
          </label>
        </div>
        
        <%= f.text_area :input, id: "message-input", class: "deepagents-input", placeholder: "Type your message...", rows: 1, required: true %>
        
        <%= f.submit "Send", class: "deepagents-send-button" %>
      <% end %>
      
      <div id="file-preview" class="deepagents-file-preview"></div>
    </div>
  </div>
  
  <% if @conversation.files.any? %>
    <div class="deepagents-files">
      <h3>Files</h3>
      <div class="deepagents-files-list">
        <% @conversation.files.each do |file| %>
          <div class="deepagents-file">
            <% if file.image? %>
              <img src="<%= file.url %>" alt="<%= file.filename %>" class="deepagents-file-preview">
            <% end %>
            <div class="deepagents-file-info">
              <span class="deepagents-file-name"><%= file.filename %></span>
              <span class="deepagents-file-timestamp"><%= time_ago_in_words(file.created_at) %> ago</span>
            </div>
            <%= link_to "Download", file.url, class: "deepagents-file-download", download: file.filename %>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
